域名   
一个完整的域名（.com、.net、.cn、.top等）由二个或二个以上部分组成，各部分之间用英文的句号”.”来分隔，最后一个”.”的右边部分称为顶级域名（TLD，）顶级域名“.”的左边部分称为一级域名，一级域名”.”的左边部分称为二级域名（SLD），二级域名的左边部分称为三级域名，以此类推，每一级的域名控制它下一级域名的分配。三级域名是形如“youa.baidu.com”的域名，可以当做是二级域名的子域名，特征为域名包含两个“.”，一般来说，三级域名都是免费的。

形如：“www.west.cn/docs/”，采取目录形式并且以“/”代替“.”的不能够称为三级域名，甚至不能称为域名，一般称之为域名下的“二级目录”。

形如：“news.west.cn”，则是二级域名。

另外像“.com.cn、.net.cn”这类，注册一个域名“example.com.cn”，这时“name.example.com.cn”是二级域名，并非三级域名。因为.com.cn是一个域名后缀，一般称为二级域。

![阿里云域名配置](https://img-blog.csdnimg.cn/20190716101741307.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzMyMjIwOA==,size_16,color_FFFFFF,t_70)
##### 记录类型：
A-将域名指向一个IPV4地址
CNAME-将域名指向另外一个域名
AAAA-将域名指向一个IPV6地址
NS-将子域名指定其他DNS服务器解析
MX-将域名指向邮件服务器地址
SRV-记录提供特定的服务的服务器
TXT-文本长度限制512,通常做SPF记录(反垃圾邮件)
CAA- CA证书颁发机构授权校验

##### 主机记录就是域名前缀，常见用法有：
www：解析后的域名为www.aliyun.com。  
@：直接解析主域名 aliyun.com。  
*：泛解析，匹配其他所有域名 *.aliyun.com。  
mail：将域名解析为mail.aliyun.com，通常用于解析邮箱服务器。  

举例：  
手机网站：如：m.aliyun.com，填写m。
显性URL：不支持泛解析（泛解析：将所有子域名解析到同一地址)
TXT-文本长度限制512.通常做SPF记录(反垃圾邮件)
CAA- CA证书颁发机构授权校验
显性URL-将域名302重定向到另外一个地址
隐性URL-与显性URL类似，但是会隐藏真实目标地址



假设原先一级域名为baidu.cn,我们需要一个叫做www.baidu.cn的域名（二级域名）,用它访问某个固定ip，直接选择记录类型为‘A’，主机记录为二级域名的名字，例如'www','bird'等，他就会将域名指向对应的IPV4地址，也就是我们希望的ip啦。在浏览器网址栏我们能看到浏览器地址栏为www.baidu.cn
测试：主机记录为*，无法访问成功。
主机记录为@，访问成功。且直接解析主域名，输入feng.bird@baidu.cn发现浏览器地址栏为baidu.cn，访问到的网页就是@刚才对应添加的ip地址。因为域名是从右往左找的，即只要遇到@，就直接解析主域名。无论前面写的是什么。
**这也是为什么客户放映出现的问题。他希望发送一个公司网页xutongxxx@huakuntech.cn，结果总是调到我这个鸟情系统里面。emmmm.......然后发现在阿里云服务器上面，huakuntech.cn域名设置中，有一条设置是，主机记录为@，记录类型为A，对应的ip就是我的系统...,把这条记录删掉就好啦~**  
当然我也可以给自己换一个域名，设置bird.huakuntech.cn,对应我的ip，每次就可以通过这个访问我的系统啦。


##### TTL
TTL(Time-To-Live)，就是一条域名解析记录在DNS服务器中的存留时间。当各地的DNS服务器接受到解析请求时，就会向域名指定的NS服务器发出解析请求从而获得解析记录；在获得这个记录之后，记录会在DNS服务器中保存一段时间，这段时间内如果再接到这个域名的解析请求，DNS服务器将不再向NS服务器发出请求，而是直接返回刚才获得的记录；而这个记录在DNS服务器上保留的时间，就是TTL值。

域名DNS分两种，一种是权威域名服务器，域名注册商的服务器都为权威域名服务器，TTL值只能在权威服务器修改，还有一种域名解析服务器就是缓存DNS服务器，比如各地ISP上网设置的DNS服务器，它的作用主要是把域名解析结果缓存到本地，方便你查询。域名DNS的TTL值实际上就是各地的DNS缓存服务器多久去你的权威域名解析服务器（NS)获取一次你域名的解析IP。



（Domain Name System，域名系统）因特网上作为域名和IP地址相互映射的一个分布式数据库，能够使用户更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。通过主机名，最终得到该主机名对应的IP地址的过程叫做域名解析（或主机名解析）。DNS协议运行在UDP协议之上，使用端口号53。
浏览器如何查找域名对应的IP地址  /  DNS解析原理
1.客户端向本机配置的本地域名服务器发出DNS域名查询请求。 
2.本地域名服务器收到请求后，先查询本地的缓存，如果有该域名的记录项，则本地域名服务器就直接把查询的结果返回给客户端；如果本地缓存中没有该域名的记录，则本地名称服务器再以DNS客户端的角色发送与前面一样的DNS域名查询请求发给根域名服务器。
3.根域名服务器收到DNS请求后，把所查询得到的所请求的DNS域名中顶级域名所对应的顶级名称服务器地址返回给本地域名服务器。
4.本地域名服务器根据根域名服务器所返回的顶级名称服务器地址，向对应的顶级域名服务器发送与前面一样的DNS域名查询请求。 
5.对应的顶级域名服务器在收到DNS查询请求后，也是先查询自己的缓存，如果有所请求的DNS域名的记录项，则相接把对应的记录项返回给本地名称服务器，然后再由本地域名服务器返回给DNS客户端，否则向本地域名服务器返回所请求的DNS域名中的二级域名所对应的二级域名服务器地址。
6.然后本地名称服务器继续按照前面介绍的方法依次地向三级、四级域名服务器查询，直到最终的对应域名所在区域的权威域名服务器返回最终的记录给本地域名服务器，然后再由本地域名服务器返回给DNS客户，同时本地域名服务器会缓存本次查询得到的记录项。
（这里默认是递归查询，查询工作由本地域名服务器替代DNS客户端进行，只需要本地名称服务器向DNS客户端返回最终的查询结果即可。而迭代查询的所有查询工作全部是DNS客户端自己进行的）

[ttl值设置多少才合适](https://blog.csdn.net/u010098331/article/details/50855815)


##### 根域

就是所谓的“.”，其实我们的网址www.baidu.com在配置当中应该是www.baidu.com.（最后有一点），一般我们在浏览器里输入时会省略后面的点，而这也已经成为了习惯。

根域服务器我们知道有13台，但是这是错误的观点。

根域服务器只是具有13个IP地址，但机器数量却不是13台，因为这些IP地址借助了任播的技术，所以我们可以在全球设立这些IP的镜像站点，你访问到的这个IP并不是唯一的那台主机。

#####  域的划分
根域下来就是顶级域或者叫一级域，
有两种划分方式，一种互联网刚兴起时的按照行业性质划分的com.，net.等，一种是按国家划分的如cn.，jp.，等。
每个域都会有域名服务器，也叫权威域名服务器。

Baidu.com就是一个顶级域名，而www.baidu.com却不是顶级域名，他是在baidu.com 这个域里的一叫做www的主机。

一级域之后还有二级域，三级域，只要我买了一个顶级域，并且我搭建了自己BIND服务器（或者其他软件搭建的）注册到互联网中，那么我就可以随意在前面多加几个域了（当然长度是有限制的）。

比如a.www.baidu.com，在这个网址中，www.baidu.com变成了一个二级域而不是一台主机，主机名是a。

##### 域名服务器
能提供域名解析的服务器，上面的记录类型可以是A(address)记录，NS记录（name server），MX（mail），CNAME等。

[详解参见博客：域名解析中A记录、CNAME、MX记录、NS记录的区别和联系](https://blog.csdn.net/crazw/article/details/8986581)

A记录是什么意思呢，就是记录一个IP地址和一个主机名字，比如我这个域名服务器所在的域test.baidu.com，我们知道这是一个二级的域名，然后我在里面有一条A记录,记录了主机为a的IP，查到了就返回给你了。

如果我现在要想baidu.com这个域名服务器查询a.test.baidu.com，那么这个顶级域名服务器就会发现你请求的这个网址在test.baidu.com这个域中，我这里记录了这个二级域的域名服务器test.baidu.com的NS的IP。我返回给你这个地址你再去查主机为a的主机把。

这些域内的域名服务器都称为权威服务器，直接提供DNS查询服务。（这些服务器可不会做递归哦）


*
域名解析中A记录、CNAME、MX记录、NS记录的区别和联系
1. A记录 又称IP指向，用户可以在此设置子域名并指向到自己的目标主机地址上，从而实现通过域名找到服务器。说明：指向的目标主机地址类型只能使用IP地址； 
附加说明： 
           1) 泛域名解析即将该域名所有未指定的子域名都指向一个空间。在“主机名”中填入*，“类型”为A，“IP地址/主机名”中填入web服务器的IP地址，点击“新增”按钮即可。 
           2) 负载均衡的实现：负载均衡(Server Load Balancing，SLB)是指在一系列资源上面动态地分布网络负载。负载均衡可以减少网络拥塞，提高整体网络性能，提高自愈性， 并确保企业关键性应用的可用性。当相同子域名有多个目标地址时，表示轮循，可以达到负载均衡的目的，但需要虚拟主机服务商支持。

 2. CNAME 通常称别名指向。您可以为一个主机设置别名。比如设置test.mydomain.com，用来指向一个主机www.rddns.com那么以后就可以用test.mydomain.com来代替访问www.rddns.com了。
说明：·
            CNAME的目标主机地址只能使用主机名，不能使用IP地址；·主机名前不能有任何其他前缀，如：http://等是不被允许的；·A记录优先于CNAME记录。即如果一个主机地址同时存在A记录和CNAME记录，则CNAME记录不生效。  

3. MX记录 邮件交换记录。用于将以该域名为结尾的电子邮件指向对应的邮件服务器以进行处理。如：用户所用的邮件是以域名mydomain.com为结尾的，则需要在管理界面中添加该域名的MX记录来处理所有以@mydomain.com结尾的邮件。 
说明：·
            MX记录可以使用主机名或IP地址；·MX记录可以通过设置优先级实现主辅服务器设置，“优先级”中的数字越小表示级别越高。也可以使用相同优先级达到负载均衡的目的；·如果在“主机名”中填入子域名则此MX记录只对该子域名生效。
附加说明：
         1) 负载均衡服务器负载均衡(Server Load Balancing，SLB)是指在一系列资源上面智能地分布网络负载。负载均衡可以减少网络拥塞，提高整体网络性能，提高自愈性，并确保企业关键性应用的可用性。当域名的MX记录有多个目标地址且优先级相同时，表示轮循，可以达到负载均衡的目的，但需要邮箱服务商支持。  

4. NS记录 解析服务器记录。用来表明由哪台服务器对该域名进行解析。这里的NS记录只对子域名生效。
   例如用户希望由12.34.56.78这台服务器解析news.mydomain.com，则需要设置news.mydomain.com的NS记录。
   说明：·“优先级”中的数字越小表示级别越高；·“IP地址/主机名”中既可以填写IP地址，也可以填写像ns.mydomain.com这样的主机地址，但必须保证该主机地址有效。
   如，将news.mydomain.com的NS记录指向到ns.mydomain.com，在设置NS记录的同时还需要设置ns.mydomain.com的指向，
   否则NS记录将无法正常解析；·NS记录优先于A记录。即，如果一个主机地址同时存在NS记录和A记录，则A记录不生效。这里的NS记录只对子域名生效。 

5. 相关说明  
   1) 负载均衡服务器负载均衡(Server Load Balancing，SLB)是指在一系列资源上面智能地分布网络负载。负载均衡可以减少网络拥塞，提高整体网络性能，提高自愈性，并确保企业关键性应用的可用性。当相同子域有多个目标地址，或域名的MX记录有多个目标地址且优先级相同时，表示轮循，可以达到负载均衡的目的，但需要虚拟主机和邮箱服务商支持。
    2) TTL值TTL值全称是“生存时间（Time To Live)”，简单的说它表示DNS记录在DNS服务器上缓存时间。东方网景DNS服务器默认即时生效，客户的增加修改一般不超过15分钟可以使用。  

TTL(Time-To-Live)，就是一条域名解析记录在DNS服务器中的存留时间。当各地的DNS服务器接受到解析请求时，就会向域名指定的NS服务器(权威域名服务器）发出解析请求从而获得解析记录；在获得这个记录之后，记录会在DNS服务器(各地的缓存服务器，也叫递归域名服务器）中保存一段时间，这段时间内如果再接到这个域名的解析请求，DNS服务器将不再向NS服务器发出请求，而是直接返回刚才获得的记录；而这个记录在DNS服务器上保留的时间，就是TTL值。
 
域名DNS分两种，一种是权威域名服务器，域名注册商的服务器都为权威域名服务器，TTL值只能在权威服务器修改，还有一种域名解析服务器就是缓存DNS服务器，比如各地ISP上网设置的DNS服务器，它的作用主要是把域名解析结果缓存到本地，方便你查询。域名DNS的TTL值实际上就是各地的DNS缓存服务器多久去你的权威域名解析服务器（NS）获取一次你域名的解析IP。

域名服务器的分类
域名服务器根据用途不同，可以进行如下分类。
1.权威域名服务器（Authoritative Name Server）
负责授权域下的域名解析服务，由上级权威域名服务器使用NS记录进行授权。有以下3级权威域名服务器。
（1）根域名服务器（Root Name Server）
最上层权威域名服务器，负责对.com、.cn、.org等顶级域名的向下授权。目前有13组这样的服务器。
这里指出是13组，而不是13台，是因为其中的大部分服务器采用了anycast技术，将其分布到不同地区，也就是说，虽然看起来只有13个IP，但实际的服务器数量远远超过了13台。Anycast是在大型DNS系统中广泛使用的多点部署、分布式方案，对于提高可用性、提高性能、抵抗DDOS有重要作用。
（2）顶级域名服务器（Top Level Name Server）
顶级域名服务器有以下2类。
通用顶级域名（Generic Top Level Domains，GTLD）服务器。例如服务于.com、 .org、.info等授权的域名服务器。
国家代码顶级域名（Country Code Top Level Domains，CCTLD）服务器。例如服务于.uk、.cn、.jp等授权的域名服务器。
完整的顶级域名服务器列表，可以从http://www.iana.org/domains/root/db这个链接获取。例如负责.cn授权的国家代码顶级域名服务器
（3）二级域名服务器（Second Level Name Server）
这类域名服务器，服务于具体域名解析，例如负责解析sdo.com域的域名服务器ns.uugame.com等。

2.缓存域名服务器（Caching Name Server）
这类域名服务器，负责接收解析器发过来的DNS请求，通过依次查询根域名服务器→顶级域名服务器→二级域名服务器来获得DNS的解析条目，然后把响应结果发送给解析器。同时根据DNS条目的TTL（Time To Live，存活时间）值进行缓存。
缓存域名服务器，有以下2个用途。
用在企业局域网内部，作为该局域网的DNS服务器。这样就可以避免内部用户的主机访问外部非授权的DNS服务器，避免DNS污染等问题。
用于电信等运营商为其租户提供域名解析服务。如上海电信的202.96.209.5和202.96.209.133都是此种类型的服务器。
用于开放DNS解析服务。如Google的8.8.8.8、Norton安全DNS 199.85.126.30及国内的114.114.114.114等都是此类。

3.转发域名服务器（Forwarding Name Server）
这类域名服务器，负责接收解析器发过来的DNS请求，转发给指定的上级域名服务器获得DNS的解析条目，然后把响应结果发送给解析器。和缓存域名服务器不同，这类域名服务器不进行任何的缓存，而仅仅是转发。

TTL值设置的应用：

1.增大TTL值，以节约域名解析时间，给网站访问加速。

一般情况下，域名的各种记录是极少更改的，很可能几个月、几年内都不会有什么变化。我们完全可以增大域名记录的TTL值让记录在各地DNS服务器中缓存的时间加长，这样在更长的一段时间内，我们访问这个网站时，本地ISP的DNS服务器就不需要向域名的NS服务器发出解析请求，而直接从缓存中返回域名解析记录。
国内和国际上很多平台的TTL值都是以秒为单位的，很多的默认值都是3600，也就是默认缓存1小时，这个值实在有点小了，难道会有人一个小时就改一次域名记录吗？您可以根据自己的需要把这个值适当的扩大，例如要缓存一天就设置成86400。Godaddy的TTL设置比较直观，但总共只有5个值可以选定，即时切换到高级设置模式也是如此，有点死板了。网站赢利环境所迫，LifeTyper.com的TTL值是设置成了最大值1周，设置成更大的值可能会有写不必要的麻烦，例如当您要更换空间时，这些旧的记录要很久才过期并被更新。

2.减小TTL值，以减少更换空间时的不可访问时间。

更换空间99.9%会有DNS记录更改的问题，因为缓存的问题，新的域名记录在有的地方可能生效了，但在有的地方可能等上一两天甚至更久才生效。结果就是有的人可能访问到了新服务器，有的人访问到了旧服务器。仅仅是访问的话，这也不是什么大问题，但如果涉及到了邮件发送，这个就有点麻烦了，说不定哪封重要信件就被发送到了那已经停掉的旧服务器上。

为了尽可能的减小这个各地的解析时间差，合理的做法是：
1）先查看域名当前的TTL值，我们假定是1天。
2）修改TTL值为可设定的最小值，可能的话，建议为1分钟，就是60。
3）等待一天，保证各地的DNS服务器缓存都过期并更新了记录。
4）设置修改新记录，这个时候各地的DNS就能以最快的速度更新到新的记录。
5）确认各地的DNS已经更新完成后，把TTL值设置成您想要的值，TTL=60还是太小了点。

域名解析的步骤

在输入网址后，域名解析通常所需步骤如下：

第一步：客户机提出域名解析请求,查找本地HOST文件后将该请求发送给本地的域名服务器。
第二步：当本地的域名服务器收到请求后,就先查询本地的缓存,如果有该纪录项,则本地的域名服务器就直接把查询的结果返回。
第三步：如果本地DNS缓存中没有该纪录,则本地域名服务器就直接把请求发给根域名服务器,然后根域名服务器再返回给本地域名服务器一个所查询域(根的子域)的主域名服务器的地址（例如请求域名为.com域，则返回负责.com域解析的主域名服务器——辅助服务器）。
第四步：本地服务器再向上一步返回的域名服务器发送请求,然后接受请求的服务器查询自己的缓存,如果没有该纪录,则返回相关的下级的域名服务器的地址。
第五步：重复第四步,直到找到正确的纪录。
第六步：本地域名服务器把返回的结果保存到缓存,以备下一次使用,同时还将结果返回给客户机。







1，什么是DNS服务器?   
   互联网是由无数台服务器和PC连接在一起组成的，每个服务器都会有一个唯一的数字标识，叫IP地址，IP地址是数字表示的，比如218.231.156.61服务器，pc之间的通信协议用的是TCP/IP协议，在底层通信里面，通信双方都是凭借IP地址和对方联系的，并没有域名参与。域名是给人记忆用的，为了能够把人记得住的名字转换成机器认识的IP地址，就需要DNS服务器来做这个“翻译”。 
   简单讲，DNS服务器就是个“翻译”，或者说是个“字典”，用来把人容易记忆的域名对照翻译成机器使用的数字格式的IP地址。

2，什么是DNS记录? 
   域名有千千万，怎么样才能知道每个域名对应的IP地址呢？答案当然要到DNS服务器（域名服务器）去找，可是谁知道要到哪个DNS服务器去找啊？这就是DNS记录的作用，DNS记录用来明确指明这个域名与IP地址的对应关系保存在哪台DNS服务器中。 
   每个域名都要有DNS记录，最多可以有六条记录，一般用2条就足够。

3，如何更改DNS记录，或者说如何更改DNS服务器？ 
   域名的DNS记录保存在顶级注册机构那里，例如.com .net保存在verisign那里。顶级注册机构一般不直接接受用户注册请求，域名注册要经过他们的“代理”即注册商来购买，修改DNS记录就需要到这些注册商那里修改。

4，修改了DNS，为何没生效? 
   这个问题有点儿复杂，为了说清楚这个问题，我们必须先搞清楚域名的解析过程，就是域名是如何翻译成IP地址的。

   举个例子：   
   当你在浏览器的地址栏输入 www.idcpcw.com 域名解析的过程就开始了：

   第一步：浏览器会查询这个域名与IP的对应关系是不是已经存在于 C:\windows\system32\drivers\etc\hosts 文件中，如果有，直接使用，寻找过程结束。如果没有，进行下一步

   第二步：浏览器询问本机预先设置好的域名服务器，一般用户是由ISP在联网成功后就分配好的。

   第三步：这个域名服务器（称为本地域名服务器）本身并不知道任何域名与IP的对应信息，但是它知道根域服务器的IP地址，所谓根域服务器就是最根源的12个服务器，他们保存了顶级域名的管辖信息，根域服务器会告诉所要查询的域名的IP数据到哪里去找。本地域名服务器就会根据这个线索找到域名的管辖服务器，然后再根据所提供的该域名的DNS记录找到这个域名的真正域名服务器（就是常说的DNS服务器，打个比方：字典），本地域名服务器从这个服务器取得IP信息后，保存在内存中，然后把IP地址返回给浏览器，中间还有很复杂的递归过程，不再赘述。

   在从“字典”取得IP数据的同时，有一个很重要的数据也一同返回，就是这个域名和IP对应关系的有效期，在这个有效期内，如果再有同样的域名请求翻译成IP地址，那这个本地域名服务器就不再到外面去找，而是直接把内存中上次就知道的IP地址返回给浏览器。直到有效期过了，它才会再次到外面去查询。

   同样如果第一次域名查询就失败了，在域名设置的有效期内，该本地域名服务器也不会再去外面找，而是直接告诉你，“这个域名找不到IP地址”。 
好了，域名和IP的查找过程简单讲就是这样，那再来回答问题：修改了DNS，为何没生效? 答案很简单：再等等，就生效了 

   那你要问，要等多久？有两个环节决定了等待的时间有多长。

   第一个环节就是DNS记录的生效时间，因为域名的DNS记录保存在顶级注册机构哪里，更新不会是实时的，以前要几个小时才会更新，现在不用这么久，顶级域名要快些，几分钟即可，国内要慢些。

   第二个环节是关键，就是这个域名的A记录原来的有效期有多长？你知道吗？ 可能你自己都不知道。 
   一般的注册商会设置成1小时，有的会几个小时。 
   如果你原来的域名A记录的有效期是几个小时，那你现在的改动，也得几个小时以后才会生效，前面讲了，本地域名服务器有缓存的。不超过有效期，是不会获取最新变动的。 
   所以，看清楚原来的设置，就是TTL的设置是多少（单位是秒，3600秒=1小时） ，你就知道要多久才会生效了。

*

反垃圾邮件技术SPF
https://www.cnblogs.com/fjlycsy/archive/2012/07/11/2586279.html 
http://blog.chinaunix.net/uid-8721861-id-2017174.html




https://www.liaoxuefeng.com/wiki/1022910821149312/1103303693824096
websocket